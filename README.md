# Урок 6.
В репозитори находятся файл вирт. машины [Vagrantfile](Vagrantfile). Файлы [time_vgs](time_vgs) [rab_vgs](rab_vgs), результаты работы с vgs. Файлы [time_mod_initrd](time_mod_initrd) [rab_mod_initrd](rab_mod_initrd), результаты работы с модулем в initrd. 
## Описание решения задания 1. Попасть в систему без пароля несколькими способами:
### 1. Способ 1. init=/bin/sh:
#### 1. Добавляем в конец строки linux 16 init=/bin/sh в загрузчике;
#### 2. Нажимаем ctrl-x. Попадаем в систему. Для смены пароля или произвести запись в файл, необходимо смонтировать корневую систему в режим rw;
* 2.1 Выполняем команду mount -o remount,rw /;
* 2.2 Если мы изменим что-либо в корневой системе, необходимо выполнить перемариковку Selinux создав файл .autorelabel в корне;
### 2. Способ 2. rd.break:
#### 1. Добавляем в конец строки linux 16 rd.break в загрузчике;
#### 2. Нажимаем ctrl-x. Попадаем в однопользовательский режим, точнее emergency mode. Корневая фс уже смонитирована;
* 2.1. Если необходимо выполнить изменения в корневой фс: mount -o remount,rw /sysroot;
* 2.2. Переходим в окружения chroot: chroot /sysroot. Выполняем необходимые изменения и создаем файла .autorelabel в корне;
### 3. Способ 3. rw init=/sysroot/bin/sh:
#### 1. В начале строки linux 16 заменяем ro на rw init=/sysroot/bin/sh в загрузчике;
#### 2. Нажимаем ctrl-x. Попадаем в систему. У нас уже смонтирована фс в режиме записи;

### Итого, разница 1 спобособа от 2 и 3 это не требуется переходить в окружение chroot. Перезагружаем систему в 1 способе через команду exec /sbin/init 6. При каждом способе, требовалось убирать в загрузчике со словом и далее console=. Для отработки маркировки фс selinux добавлял в загрузчик enforcing=0 autorelabel=1.

## Описание решения задания 2. Установить систему с LVM, после чего переименовать VG. добавить модуль initrd:
### 1. Смотрим какие vgs есть, команда vgs;
### 2. Переименовываем vgs командой vgrename;
### 3. После переименовывания правим след. конф. файлы /etc/fstab, /etc/default/grub, /boot/grub2/grub.cfg;
### 4. Пересоздаем initrd image, чтобы т.к. мы изменили имя volume group, для обращения. Команда mkinitrd -f -v /boot/initramfs-$(uname -r).img $(uname -r);
### 5. Перезагружаемся и проверяем новое имя vgs;

```
[root@lesson6 ~]# vgs
  VG        #PV #LV #SN Attr   VSize   VFree
  OtusRoot1   1   2   0 wz--n- <38,97g    0 
```
### 6. Модуль inird. Создаём папку в каталоге где хранятся модули, для добавления своего модуля. В нем помещаем два скрипта. Первый скрипт устанавливает сам модуль, второй вызывает скрипт, это рисунок. После пересобираем образ initrd. Операции отражены в script;  
